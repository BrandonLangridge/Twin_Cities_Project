<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>City Map | Twin Cities</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="page-header" role="banner">
    <button id="back-btn" onclick="window.location.href='index.php'" aria-label="Go back to city selection">Back</button>
    
    <h1 id="city-title" aria-live="polite"></h1>
    
    <button id="accessibility-toggle" aria-pressed="false">Colour Blind Mode</button>
  </div>

  <main id="map" role="main" aria-label="Interactive city map"></main>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  
  <script src="pois.js"></script>
  
  <script src="maps.js"></script>

  <script>
    /* Retrieving settings from localStorage to ensure the user's accessibility experience
       is continuous across different pages of the application.
    */
    const voiceEnabled = localStorage.getItem("voiceEnabled") === "true";
    const colorBlindEnabled = localStorage.getItem("colorBlindEnabled") === "true";

    // Applying the high-contrast/colorblind filter if the state is active
    if (colorBlindEnabled) { document.body.classList.add("colorblind"); }

    /* SHARED AUDIO FEEDBACK FUNCTION
       Standardised across the project to provide consistent voice-over responses.
    */
    function speak(text) {
      if (!voiceEnabled || !window.speechSynthesis) return;
      window.speechSynthesis.cancel(); // Clears any current speech queue to prevent overlapping audio
      const msg = new SpeechSynthesisUtterance(text);
      window.speechSynthesis.speak(msg);
    }

    /* ACCESSIBILITY INTERACTION
       Updates both the visual CSS class and the ARIA attribute for screen readers.
    */
    const accessibilityBtn = document.getElementById("accessibility-toggle");
    accessibilityBtn.setAttribute("aria-pressed", colorBlindEnabled);

    accessibilityBtn.addEventListener("click", () => {
      // Toggle the CSS class on the body tag
      const isEnabled = document.body.classList.toggle("colorblind");
      
      // Update the accessibility state in LocalStorage for persistence
      localStorage.setItem("colorBlindEnabled", isEnabled);
      
      // Update ARIA for screen reader users
      accessibilityBtn.setAttribute("aria-pressed", isEnabled);
      
      // Provide immediate audio confirmation
      speak(isEnabled ? "Color blind mode enabled" : "Color blind mode disabled");
    });
  </script>
</body>
</html>






